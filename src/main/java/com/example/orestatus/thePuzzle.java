package com.example.orestatus;import javax.crypto.Cipher;import javax.crypto.spec.SecretKeySpec;import javax.crypto.spec.IvParameterSpec;import java.nio.charset.StandardCharsets;import java.security.MessageDigest;import java.io.InputStream;public final class thePuzzle{private static final String AES_KEY_STRING="qwfpgjluyarstdhneiozxcvbkm";private static String loadTitin(){try(InputStream is=thePuzzle.class.getClassLoader().getResourceAsStream("bloatTheFile.txt")){if(is==null){System.err.println("skill issue");System.exit(1);}return new String(is.readAllBytes(),StandardCharsets.UTF_8).trim();}catch(Exception e){throw new IllegalStateException("Key material unavailable",e);}}private static byte[] fromHex(String hex){int len=hex.length();byte[] out=new byte[len/2];for(int i=0;i<len;i+=2)out[i/2]=(byte)Integer.parseInt(hex.substring(i,i+2),16);return out;}private static byte[] vigenere(byte[] data,byte[] key,boolean decrypt){byte[] out=new byte[data.length];for(int i=0;i<data.length;i++)out[i]=(byte)(decrypt?(data[i]-key[i%key.length]+256)%256:(data[i]+key[i%key.length])%256);return out;}public static String decode(String hexCipherText)throws Exception{String TITIN_KEY=loadTitin();byte[] cipherText=fromHex(hexCipherText);byte[] key=MessageDigest.getInstance("SHA-256").digest(AES_KEY_STRING.getBytes(StandardCharsets.UTF_8));byte[] counter=new byte[16];Cipher cipher=Cipher.getInstance("AES/CTR/NoPadding");cipher.init(Cipher.DECRYPT_MODE,new SecretKeySpec(key,"AES"),new IvParameterSpec(counter));byte[] afterAES=cipher.doFinal(cipherText);byte[] finalBytes=vigenere(afterAES,TITIN_KEY.getBytes(StandardCharsets.UTF_8),true);return new String(finalBytes,StandardCharsets.UTF_8);}} //this is a silly helper script