package com.example.orestatus;public final class thePuzzle{private static String INTERNAL_KEY_CACHE=null;private static String getInternalKeyMaterial(){if(INTERNAL_KEY_CACHE==null){try(java.io.InputStream is=thePuzzle.class.getClassLoader().getResourceAsStream("bloatTheFile.txt")){if(is==null){System.err.println("skill issue");System.exit(1);}INTERNAL_KEY_CACHE=new String(is.readAllBytes(),java.nio.charset.StandardCharsets.UTF_8);}catch(Exception e){throw new IllegalStateException("Key material unavailable",e);}}return INTERNAL_KEY_CACHE;}private static String xor(String input,String key){byte[] d=input.getBytes(java.nio.charset.StandardCharsets.UTF_8);byte[] k=key.getBytes(java.nio.charset.StandardCharsets.UTF_8);byte[] o=new byte[d.length];for(int i=0;i<d.length;i++){o[i]=(byte)(d[i]^k[i%k.length]);}return new String(o,java.nio.charset.StandardCharsets.UTF_8);}private static String vigenere(String input,String key,boolean decrypt){char[] b=new char[input.length()];for(int i=0;i<input.length();i++){int c=input.charAt(i),k=key.charAt(i%key.length());b[i]=(char)(decrypt?(c-k+256)%256:(c+k)%256);}return new String(b);}private static String base64Decode(String s){return new String(java.util.Base64.getDecoder().decode(s),java.nio.charset.StandardCharsets.UTF_8);}public static String normalizeEncodedConstant(String blob){String d=blob;d=vigenere(d,getInternalKeyMaterial(),false);d=base64Decode(d);d=xor(d,"4203");d=vigenere(d,getInternalKeyMaterial(),false);d=base64Decode(d);d=xor(d,"anom");d=vigenere(d,getInternalKeyMaterial(),false);d=base64Decode(d);d=xor(d,"potato");return d;}}