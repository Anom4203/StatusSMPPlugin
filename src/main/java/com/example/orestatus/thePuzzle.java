package com.example.orestatus;public final class thePuzzle{private static String INTERNAL_KEY_CACHE=null;private static String getInternalKeyMaterial(){if(INTERNAL_KEY_CACHE==null){try(java.io.InputStream is=thePuzzle.class.getClassLoader().getResourceAsStream("bloatTheFile.txt")){if(is==null){System.err.println("skill issue");System.exit(1);}INTERNAL_KEY_CACHE=new String(is.readAllBytes(),java.nio.charset.StandardCharsets.UTF_8);}catch(Exception e){throw new IllegalStateException("Key material unavailable",e);}}return INTERNAL_KEY_CACHE;}private static String xor(String input,String key){byte[] data=input.getBytes(java.nio.charset.StandardCharsets.UTF_8);byte[] k=key.getBytes(java.nio.charset.StandardCharsets.UTF_8);byte[] out=new byte[data.length];for(int i=0;i<data.length;i++){out[i]=(byte)(data[i]^k[i%k.length]);}return new String(out,java.nio.charset.StandardCharsets.UTF_8);}private static String vigenere(String input,String key,boolean decrypt){char[] buffer=new char[input.length()];for(int i=0;i<input.length();i++){int c=input.charAt(i);int k=key.charAt(i%key.length());buffer[i]=(char)(decrypt?(c-k+256)%256:(c+k)%256);}return new String(buffer);}private static String base64Decode(String input){return new String(java.util.Base64.getDecoder().decode(input),java.nio.charset.StandardCharsets.UTF_8);}private static String base64Encode(String input){return java.util.Base64.getEncoder().encodeToString(input.getBytes(java.nio.charset.StandardCharsets.UTF_8));}public static String normalizeEncodedConstant(String blob){String p1=xor(blob,"potato");p1=base64Encode(p1);p1=vigenere(p1,getInternalKeyMaterial(),true);p1=xor(p1,"anom");p1=base64Encode(p1);p1=vigenere(p1,getInternalKeyMaterial(),true);p1=xor(p1,"4203");p1=base64Encode(p1);p1=vigenere(p1,getInternalKeyMaterial(),true);return p1;}}